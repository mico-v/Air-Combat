# æ¡†æ¶å¿«é€Ÿå‚è€ƒæŒ‡å—

è¿™æ˜¯ä¸€ä¸ªç²¾ç®€çš„å¿«é€Ÿå‚è€ƒæŒ‡å—ï¼Œåˆ—å‡ºäº†æœ€å¸¸ç”¨çš„å‡½æ•°å’Œä½¿ç”¨æ–¹æ³•ã€‚

## ğŸ“‹ ç›®å½•

- [é…ç½®å‚æ•°](#é…ç½®å‚æ•°)
- [æ•°æ®ç±»å‹](#æ•°æ®ç±»å‹)
- [å·¥å…·å‡½æ•°](#å·¥å…·å‡½æ•°)
- [è¾“å…¥ç³»ç»Ÿ](#è¾“å…¥ç³»ç»Ÿ)
- [æ ¸å¿ƒç³»ç»Ÿ](#æ ¸å¿ƒç³»ç»Ÿ)
- [åœºæ™¯ç³»ç»Ÿ](#åœºæ™¯ç³»ç»Ÿ)
- [æ¸¸æˆå¯¹è±¡](#æ¸¸æˆå¯¹è±¡)

---

## é…ç½®å‚æ•°

**æ–‡ä»¶**: `src/util/config.h`

```cpp
// çª—å£å¤§å°
WINDOW_WIDTH       // 1000
WINDOW_HEIGHT      // 800

// æ¸¸æˆåŒºåŸŸ
GAME_WIDTH         // 800
GAME_HEIGHT        // 800

// æ¸¸æˆå¯¹è±¡å¤§å°
PLAYER_WIDTH       // 80
PLAYER_HEIGHT      // 120
ENEMY_WIDTH        // 80
ENEMY_HEIGHT       // 80

// æ¸¸æˆå‚æ•°
PLAYER_SPEED       // 500.0
BULLET_SPEED       // 800.0
ENEMY_SPEED        // 200.0
```

---

## æ•°æ®ç±»å‹

**æ–‡ä»¶**: `src/util/type.h`

### Vector2 - äºŒç»´å‘é‡

```cpp
Vector2 pos = {100.0, 200.0};  // åˆ›å»ºå‘é‡
pos.x += 10;                    // ä¿®æ”¹ x
pos.y += 10;                    // ä¿®æ”¹ y
```

### Rect - çŸ©å½¢

```cpp
Rect rect;
rect.left = 0;
rect.right = 100;
rect.top = 0;
rect.bottom = 100;
```

### Circle - åœ†å½¢

```cpp
Circle circle;
circle.center = {100, 100};
circle.radius = 50;
```

### Attribute - å±æ€§

```cpp
Attribute attr;
attr.health = 3;          // ç”Ÿå‘½å€¼
attr.score = 0;           // åˆ†æ•°
attr.speed = 500.0;       // é€Ÿåº¦
attr.maxBulletCd = 0.1;   // æœ€å¤§å­å¼¹å†·å´
attr.bulletCd = 0.0;      // å½“å‰å­å¼¹å†·å´
```

---

## å·¥å…·å‡½æ•°

**æ–‡ä»¶**: `src/util/util.h`

### æ•°å­¦å‡½æ•°

```cpp
// å‘é‡é•¿åº¦
double len = Length(v);

// å½’ä¸€åŒ–ï¼ˆå˜æˆé•¿åº¦ä¸º 1ï¼‰
Vector2 normalized = Normalize(v);

// ä¸¤ç‚¹è·ç¦»
double dist = Distance(p1, p2);

// é™åˆ¶èŒƒå›´
double clamped = Clamp(value, min, max);
```

### éšæœºæ•°

```cpp
int randomInt = GetRandomInt(1, 100);        // 1-100 çš„éšæœºæ•´æ•°
double randomDouble = GetRandomDouble(0, 1); // 0-1 çš„éšæœºå°æ•°
bool randomBool = GetRandomBool();           // éšæœº true/false
```

### ç¢°æ’æ£€æµ‹

```cpp
// çŸ©å½¢ä¸çŸ©å½¢
if (IsRectRectCollision(rect1, rect2)) { /* ç¢°æ’äº† */ }

// çŸ©å½¢ä¸åœ†å½¢
if (IsRectCircleCollision(rect, circle)) { /* ç¢°æ’äº† */ }

// åœ†å½¢ä¸åœ†å½¢
if (IsCircleCircleCollision(circle1, circle2)) { /* ç¢°æ’äº† */ }

// ç‚¹åœ¨çŸ©å½¢å†…
if (IsPointInRect(point, rect)) { /* åœ¨çŸ©å½¢å†… */ }
```

---

## è¾“å…¥ç³»ç»Ÿ

### é”®ç›˜

**æ–‡ä»¶**: `src/util/keyboard.h`

```cpp
// æ£€æŸ¥æŒ‰é”®æ˜¯å¦æŒ‰ä¸‹
if (GetKeyDown(VK_SPACE))  { /* ç©ºæ ¼é”®æŒ‰ä¸‹ */ }
if (GetKeyDown('W'))       { /* W é”®æŒ‰ä¸‹ */ }
if (GetKeyDown(VK_UP))     { /* ä¸Šæ–¹å‘é”®æŒ‰ä¸‹ */ }

// WASD ç§»åŠ¨ç¤ºä¾‹
Vector2 direction = {0, 0};
if (GetKeyDown('W')) direction.y -= 1;
if (GetKeyDown('S')) direction.y += 1;
if (GetKeyDown('A')) direction.x -= 1;
if (GetKeyDown('D')) direction.x += 1;
direction = Normalize(direction);
```

**å¸¸ç”¨é”®ç **:
- `VK_SPACE` - ç©ºæ ¼
- `VK_RETURN` - å›è½¦
- `VK_ESCAPE` - ESC
- `VK_UP`, `VK_DOWN`, `VK_LEFT`, `VK_RIGHT` - æ–¹å‘é”®
- `'W'`, `'A'`, `'S'`, `'D'` - å­—æ¯é”®ï¼ˆå¤§å†™ï¼‰

### é¼ æ ‡

**æ–‡ä»¶**: `src/util/mouse.h`

```cpp
// è·å–é¼ æ ‡ä½ç½®
int x = GetMouseX();
int y = GetMouseY();

// æ£€æŸ¥é¼ æ ‡æŒ‰é”®
if (IsMouseLButtonDown()) { /* å·¦é”®æŒ‰ä¸‹ */ }
if (IsMouseRButtonDown()) { /* å³é”®æŒ‰ä¸‹ */ }

// æ£€æµ‹æŒ‰é’®ç‚¹å‡»ç¤ºä¾‹
if (IsMouseLButtonDown())
{
    int mouseX = GetMouseX();
    int mouseY = GetMouseY();
    PressButtons(mouseX, mouseY);
}
```

---

## æ ¸å¿ƒç³»ç»Ÿ

**æ–‡ä»¶**: `src/core/core.h` *(è®¡åˆ’ä¸­)*

### æ¸¸æˆæ—¶é—´

```cpp
double gameTime = GetGameTime();  // è·å–æ¸¸æˆè¿è¡Œæ€»æ—¶é—´ï¼ˆç§’ï¼‰
```

### æ—¥å¿—è¾“å‡º

```cpp
Log(1, TEXT("ç©å®¶ä½ç½®: x=%f, y=%f"), player->x, player->y);
Log(1, TEXT("æ•Œäººæ•°é‡: %d"), enemyCount);
```

---

## åœºæ™¯ç³»ç»Ÿ

**æ–‡ä»¶**: `src/scene/scene.h` *(è®¡åˆ’ä¸­)*

### åœºæ™¯åˆ‡æ¢

```cpp
// åˆ‡æ¢åˆ°å¼€å§‹åœºæ™¯
ChangeScene(StartScene);

// åˆ‡æ¢åˆ°æ¸¸æˆåœºæ™¯
ChangeScene(GameScene);

// è·å–å½“å‰åœºæ™¯
Scene* scene = GetCurrentScene();
SceneId currentId = scene->sceneId;
```

### åœºæ™¯å‡½æ•°ï¼ˆæ¯ä¸ªåœºæ™¯å¿…é¡»å®ç°ï¼‰

```cpp
void LoadScene_XXX()                // åœºæ™¯åŠ è½½æ—¶
void UnloadScene_XXX()              // åœºæ™¯å¸è½½æ—¶
void ProcessUiInput_XXX()           // å¤„ç† UI è¾“å…¥
void CheckCollision_XXX()           // æ£€æµ‹ç¢°æ’
void UpdateScene_XXX(double dt)     // æ›´æ–°é€»è¾‘
void RenderScene_XXX(HDC, HDC)      // ç»˜åˆ¶åœºæ™¯
```

---

## æ¸¸æˆå¯¹è±¡

### ç©å®¶

**æ–‡ä»¶**: `src/game_object/player.h` *(è®¡åˆ’ä¸­)*

```cpp
// åˆ›å»ºç©å®¶
CreatePlayer();

// è·å–ç©å®¶
Player* player = GetPlayer();

// æ›´æ–°ç©å®¶
UpdatePlayer(deltaTime);

// ç»˜åˆ¶ç©å®¶
RenderPlayer(hdc_memBuffer, hdc_loadBmp);

// é”€æ¯ç©å®¶
DestroyPlayer();
```

### æ•Œäºº

**æ–‡ä»¶**: `src/game_object/enemy.h` *(è®¡åˆ’ä¸­)*

```cpp
// åˆ›å»ºæ•Œäºº
CreateEnemy(x, y);
CreateRandomEnemy();

// è·å–æ‰€æœ‰æ•Œäºº
std::vector<Enemy*> enemies = GetEnemies();

// æ›´æ–°æ‰€æœ‰æ•Œäºº
UpdateEnemies(deltaTime);

// ç»˜åˆ¶æ‰€æœ‰æ•Œäºº
RenderEnemies(hdc_memBuffer, hdc_loadBmp);

// é”€æ¯æ•Œäºº
DestroyEnemy(enemy);
DestroyEnemies();  // é”€æ¯æ‰€æœ‰
```

### å­å¼¹

**æ–‡ä»¶**: `src/game_object/bullet.h` *(è®¡åˆ’ä¸­)*

```cpp
// åˆ›å»ºå­å¼¹
CreateBullet(x, y, damage, speed);

// è·å–æ‰€æœ‰å­å¼¹
std::vector<Bullet*> bullets = GetBullets();

// æ›´æ–°æ‰€æœ‰å­å¼¹
UpdateBullets(deltaTime);

// ç»˜åˆ¶æ‰€æœ‰å­å¼¹
RenderBullets(hdc_memBuffer, hdc_loadBmp);

// é”€æ¯å­å¼¹
DestroyBullet(bullet);
DestroyBullets();  // é”€æ¯æ‰€æœ‰
```

---

## å¸¸ç”¨ä»£ç æ¨¡å¼

### ç§»åŠ¨æ¸¸æˆå¯¹è±¡

```cpp
// ä½¿ç”¨ deltaTime ä¿è¯åŒ€é€Ÿè¿åŠ¨
object->x += direction.x * speed * deltaTime;
object->y += direction.y * speed * deltaTime;

// é™åˆ¶åœ¨å±å¹•å†…
object->x = Clamp(object->x, 0, GAME_WIDTH - object->width);
object->y = Clamp(object->y, 0, GAME_HEIGHT - object->height);
```

### å®šæ—¶ç”Ÿæˆå¯¹è±¡

```cpp
static double lastSpawnTime = 0;
double currentTime = GetGameTime();

if (currentTime - lastSpawnTime > 1.0)  // æ¯ 1 ç§’
{
    CreateEnemy();
    lastSpawnTime = currentTime;
}
```

### å°„å‡»å†·å´

```cpp
// åœ¨ Update ä¸­
if (GetKeyDown(VK_SPACE))
{
    if (player->bulletCd <= 0)
    {
        FireBullet();
        player->bulletCd = player->maxBulletCd;
    }
}

// æ›´æ–°å†·å´æ—¶é—´
player->bulletCd -= deltaTime;
if (player->bulletCd < 0) player->bulletCd = 0;
```

### ç¢°æ’æ£€æµ‹

```cpp
// ç©å®¶ä¸æ•Œäºº
Rect playerRect = CreateRect(player->position, player->width, player->height);

for (Enemy* enemy : GetEnemies())
{
    Rect enemyRect = CreateRect(enemy->position, enemy->width, enemy->height);
    
    if (IsRectRectCollision(playerRect, enemyRect))
    {
        // ç¢°æ’å¤„ç†
        player->health--;
        player->score += enemy->score;
        DestroyEnemy(enemy);
    }
}
```

### æŒ‰é’®ç‚¹å‡»

```cpp
void ProcessUiInput()
{
    if (IsMouseLButtonDown())
    {
        PressButtons(GetMouseX(), GetMouseY());
    }
}
```

---

## è°ƒè¯•æŠ€å·§

### è¾“å‡ºæ—¥å¿—

```cpp
Log(1, TEXT("å˜é‡å€¼: %d"), value);
Log(1, TEXT("ä½ç½®: (%.2f, %.2f)"), x, y);
```

### è®¾ç½®æ–­ç‚¹

1. åœ¨ä»£ç è¡Œå·¦ä¾§ç‚¹å‡»è®¾ç½®æ–­ç‚¹ï¼ˆçº¢ç‚¹ï¼‰
2. æŒ‰ F5 å¯åŠ¨è°ƒè¯•
3. ç¨‹åºä¼šåœ¨æ–­ç‚¹å¤„æš‚åœ
4. æŸ¥çœ‹å˜é‡å€¼

### å•æ­¥æ‰§è¡Œ

- `F10` - å•æ­¥è·³è¿‡ï¼ˆä¸è¿›å…¥å‡½æ•°ï¼‰
- `F11` - å•æ­¥è¿›å…¥ï¼ˆè¿›å…¥å‡½æ•°å†…éƒ¨ï¼‰
- `F5` - ç»§ç»­æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹

---

## å¸¸è§é—®é¢˜

### Q: å¯¹è±¡ä¸æ˜¾ç¤ºï¼Ÿ

- æ£€æŸ¥æ˜¯å¦è°ƒç”¨äº† Render å‡½æ•°
- æ£€æŸ¥ä½ç½®æ˜¯å¦åœ¨å±å¹•å†…
- æ£€æŸ¥èµ„æºæ˜¯å¦æ­£ç¡®åŠ è½½

### Q: å¯¹è±¡ä¸ç§»åŠ¨ï¼Ÿ

- æ£€æŸ¥æ˜¯å¦è°ƒç”¨äº† Update å‡½æ•°
- æ£€æŸ¥ deltaTime æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥é€Ÿåº¦æ˜¯å¦ä¸º 0

### Q: ç¨‹åºå´©æºƒï¼Ÿ

- æ£€æŸ¥æ˜¯å¦è®¿é—®äº†ç©ºæŒ‡é’ˆ
- æ£€æŸ¥æ•°ç»„æ˜¯å¦è¶Šç•Œ
- ä½¿ç”¨è°ƒè¯•å™¨å®šä½å´©æºƒä½ç½®

### Q: å†…å­˜æ³„æ¼ï¼Ÿ

- æ£€æŸ¥ new å’Œ delete æ˜¯å¦é…å¯¹
- æ£€æŸ¥ UnloadScene æ˜¯å¦æ¸…ç†äº†æ‰€æœ‰å¯¹è±¡

---

## å®Œæ•´ç¤ºä¾‹ï¼šç©å®¶æ›´æ–°å‡½æ•°

```cpp
void UpdatePlayer(double deltaTime)
{
    Player* player = GetPlayer();
    
    // 1. å¤„ç†ç§»åŠ¨è¾“å…¥
    Vector2 direction = {0, 0};
    if (GetKeyDown('W')) direction.y -= 1;
    if (GetKeyDown('S')) direction.y += 1;
    if (GetKeyDown('A')) direction.x -= 1;
    if (GetKeyDown('D')) direction.x += 1;
    
    // 2. å½’ä¸€åŒ–æ–¹å‘
    direction = Normalize(direction);
    
    // 3. ç§»åŠ¨ç©å®¶
    player->position.x += direction.x * player->speed * deltaTime;
    player->position.y += direction.y * player->speed * deltaTime;
    
    // 4. é™åˆ¶åœ¨å±å¹•å†…
    player->position.x = Clamp(player->position.x, 0, GAME_WIDTH - player->width);
    player->position.y = Clamp(player->position.y, 0, GAME_HEIGHT - player->height);
    
    // 5. å¤„ç†å°„å‡»
    if (GetKeyDown(VK_SPACE))
    {
        if (player->bulletCd <= 0)
        {
            CreateBullet(
                player->position.x + player->width / 2,
                player->position.y,
                1,
                800.0
            );
            player->bulletCd = player->maxBulletCd;
        }
    }
    
    // 6. æ›´æ–°å†·å´æ—¶é—´
    if (player->bulletCd > 0)
        player->bulletCd -= deltaTime;
}
```

---

## æ›´å¤šä¿¡æ¯

- å®Œæ•´ API æ–‡æ¡£ï¼š`docs/APIæ–‡æ¡£.md`
- æ¡†æ¶è¯¦è§£ï¼š`docs/02-æ¡†æ¶æ¦‚è§ˆ.md`
- ç¯å¢ƒæ­å»ºï¼š`SETUP.md`
- é¡¹ç›®æ¦‚è¿°ï¼š`README.md`
- å®éªŒæŒ‡å¯¼ï¼š`GuideBook.md`

---

ç¥ä½ å¼€å‘æ„‰å¿«ï¼ğŸ®âœˆï¸
